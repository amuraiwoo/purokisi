import{k as f,s as h,g as y}from"./hoisted.Trl-Egcw.js";import{p as v}from"./events.B_LcBSsC.js";import{S as s,s as x,c as w}from"./index.CfWw5B3X.js";import{S as p}from"./types.CFIYXINY.js";const b={"discord.gg":"uv","discord.com":"uv","spotify.com":"uv","spotify.link":"uv","youtube.com":"uv","youtu.be":"uv"};function S(e,t){try{return new URL(e).toString()}catch{}try{const t=new URL(`http://${e}`);if(t.hostname.includes("."))return t.toString()}catch{}return t.replace("%s",encodeURIComponent(e))}async function E(e){const t=localStorage.getItem(s.ProxySettings.searchEngine),n=localStorage.getItem(s.ProxySettings.openIn);let o=__uv$config.prefix+__uv$config.encodeUrl(S(e,t?p[t]:p.ddg));return"a:b"===n||"blob"===n?w(n,"https://google.com",`${window.location.origin}${o}`):"direct"===n?window.location.href=o:o}async function l(e,t){const{sw:n,conn:o}=y();await h(o,localStorage.getItem(s.ProxySettings.transport)),await x.marketPlaceSettings.handlePlugins(n),e.classList.remove("hidden");const r=await E(t);r&&(e.src=r)}v((async()=>{const e=document.getElementById("nebula-input"),t=document.getElementById("neb-iframe"),n=document.getElementById("omnibox"),o=document.getElementById("version"),r=new f;e?.addEventListener("keypress",(async function(n){"Enter"===n.key&&(o.classList.add("hidden"),("automatic"===localStorage.getItem(s.ProxySettings.proxy)||"uv"===localStorage.getItem(s.ProxySettings.proxy))&&l(t,e?.value))})),e?.addEventListener("input",(async function(){n.innerHTML="";const t=e?.value;if(e.classList.remove("rounded-b-2xl"),n.classList.remove("hidden"),0===t.length&&(e.classList.add("rounded-b-2xl"),n.classList.add("hidden")),t.length>=3){const o=(await(await r.fetch(`https://api.duckduckgo.com/ac?q=${encodeURIComponent(t)}&format=json`)).json()).slice(0,8);o&&(n.innerHTML="",o.map((t=>{let o=document.createElement("span"),s=document.createElement("p");o.classList.add("cursor-pointer","font-roboto","border-b","border-input-border-color","last:rounded-b-xl","last:border-none","text-ellipsis","whitespace-nowrap","w-full","text-input-text","h-9","text-xl","text-align-center","overflow-hidden","flex","items-center","justify-center","hover:bg-lighter","active:bg-primary"),o.addEventListener("click",(function(){const n=new KeyboardEvent("keypress",{key:"Enter",code:"Enter",which:13,keyCode:13});e.value=t.phrase,e.dispatchEvent(n)})),s.classList.add("cursor-pointer","text-ellipsis","text-center","w-full","overflow-hidden","whitespace-nowrap"),s.innerText=t.phrase,o.appendChild(s),n.appendChild(o)})))}}))}));